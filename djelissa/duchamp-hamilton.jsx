#includepath "~/Documents/;%USERPROFILE%Documents";#include "basiljs/bundle/basil.js";#include "yo.js";// http://www.indiscripts.com/category/snippets//// http://freewebdesigntutorials.com/javaScriptTutorials/jsArrayObject/randomizeArrayElements.htm// http://javascript.about.com/library/blsort2.htm// http://wwwimages.adobe.com/content/dam/Adobe/en/products/indesign/pdfs/JavaScriptToolsGuide_CS5.pdf// http://partners.adobe.com/public/developer/en/indesign/sdk/WorkingWithDocumentsJS.pdf// // you can get all the elements you have selected in indesign via b.selection()// there a two different ways to use the b.selections() function// duchamp-hamilton.jsx pour Djelissa Latini// duchamp_hamilton_code.xmlvar xmlString;function randOrd(){    return (Math.round(Math.random())-0.5);}function setup(){              xmlString = b.loadString("duchamp_hamilton_code.xml");        var xmlStr = new XML ( xmlString);        var xmlStr2 = new XML ( xmlString);        var duchampXML = xmlStr2.duchamp;        //b.println(duchampXML);        b.println("---------------");        duchampTab = new Array();    var nbrDuchamp = duchampXML.length();            for(var i = 0; i< nbrDuchamp; i++){                duchampTab.push(duchampXML[i].text());     }        duchampTab.sort( randOrd );        //b.println(duchampTab);            //parser = new DOMParser();    //xmlDoc = parser.parseFromString(xmlString,"text/xml");        //b.println(xmlStr.p[0]);        var nbr = xmlStr.elements().length();        var compteur = 0;        for(var i = 0; i< nbr; i++){                //b.println(xmlStr.elements()[i]);                if(xmlStr.elements()[i].name() == "duchamp"){                        //b.println("duchamp");            xmlStr.elements()[i] = "";            xmlStr.elements()[i].contents = duchampTab[compteur];                        //b.println(duchampTab[compteur] ) ;                        compteur++;                        }else{                                 //b.println("autre");                            }             }                    b.println( xmlStr.toString() );            //b.saveString("data/melange.xml", xmlStr.toString() );     }function draw() {/*    var myDocument = app.activeDocument;                var myXMLImportPreferences = myDocument.xmlImportPreferences;    myXMLImportPreferences.allowTransform = false;    myXMLImportPreferences.createLinkToXML = false;    myXMLImportPreferences.ignoreUnmatchedIncoming = false;    myXMLImportPreferences.ignoreWhitespace = true;    myXMLImportPreferences.importCALSTables = true;    myXMLImportPreferences.importStyle = XMLImportStyles.mergeImport;    myXMLImportPreferences.importTextIntoTables = false;    myXMLImportPreferences.importToSelected = false;    myXMLImportPreferences.removeUnmatchedExisting = false;    myXMLImportPreferences.repeatTextElements = true;        myDocument.importXML(File("/Volumes/Macintosh\ HD/Users/loic/Documents/COURS/STRASBOURG/2014-2015/A4/BASILJS-coder-un-livre/djelissa/data/melange.xml"));*/}b.go();