#includepath "~/Documents/;%USERPROFILE%Documents";#include "basiljs/bundle/basil.js";// you can get all the elements you have selected in indesign via b.selection()// there a two different ways to use the b.selections() function// godot.jsx pour Clara Neumann// caractere de fin de style impbriqué :  (~h en GREP)// sert à préciser si on veut nettoyer le texte ou pasvar nettoyage = false;// liste des lettres que l'on cherchevar lettres = Array('g','o','d','o','t');// on sélectionne la première lettre du tableauvar godotCounter = 0;function draw() {    // on  récupère la sélection (il faut que ce soit du texte sélectionné)    var mySelection = b.selections();    // initialisation de la variable de texte    var texte ="";    // on stocke le contenu de la sélection dans la variable texte    for (var i = 0; i < mySelection.length; i++) {    	b.println("element "+i+" is a: "+ mySelection[i] );    	texte += mySelection[i].contents;    }    // on convertit texte en tableau après avoir séparé tous les caractères    texte = texte.split("");            // on parcours tous les éléments du tableau texte, donc tous les signes du texte sélectionné    for (var c = 0; c < texte.length; c++){                // on nettoie les caractères de fin de style imbriqué        if(texte[c] == ""){            texte[c] = "";        }                // si on n'est pas en nettoyage        if(nettoyage == false){                        // on vérifie si le caractère correspond à une des lettres recherchées (dans l'ordre) et sans tenir compte des lettres capitales            if(texte[c].toLowerCase() == lettres[godotCounter]){                b.println("youpi " + texte[c] + " " +c);                // si le caractère est trouvé, on l'encadre avec le caractère masqué de fin de style imbriqué                texte[c] = ""+texte[c]+"";                // on incrémente la variable de recherche de lettres                godotCounter = (godotCounter+1)%lettres.length;            }        }    }    // on refusionne tout le tableau    texte = texte.join("");        // on remplie la sélection avec le texte fusionné    b.selections()[0].contents = texte;    b.println("---");}b.go();